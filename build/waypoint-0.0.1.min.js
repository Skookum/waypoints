(function(c,d,f,e){function g(){this._ignore=e;this._debug=!1}g.prototype={resume:function(a){this.history();var b=this.target();if(b){this.target(e);if(b!==this.route())return this._debug&&console.log("Waypoint.resume(): bad link -- target ("+b+") does not match route ("+this.route()+"), redirecting..."),this.redirect(),this;this._debug&&console.log("Waypoint.resume(): good link -- arrived at target("+b+"), bookmarking...");this.bookmark()}else if(this.route()!==this.latest())return this._debug&&
console.log("Waypoint.resume(): bad route -- route("+this.route()+") does not match latest ("+this.latest()+"), redirecting..."),this.redirect(),this;this._debug&&console.log("Waypoint.resume(): good route -- arrived at route("+this.route()+"), triggering callback...");a&&a();return this},debug:function(a){if(0===arguments.length)return this._debug;this._debug=a},clear:function(){localStorage.removeItem("Waypoint.history");localStorage.removeItem("Waypoint.target");return this},bookmark:function(){this.push(this.route());
return this},push:function(a){var b=this.history();b.push(a);5<b.length&&b.shift();this.history(b);return this},history:function(a){if(0===arguments.length){var b=localStorage.getItem("Waypoint.history");return JSON.parse(b)||[]}a?localStorage.setItem("Waypoint.history",JSON.stringify(a)):localStorage.removeItem("Waypoint.history")},target:function(a){if(0===arguments.length){var b=localStorage.getItem("Waypoint.target");return JSON.parse(b)}a?localStorage.setItem("Waypoint.target",JSON.stringify(a)):
localStorage.removeItem("Waypoint.target")},ignore:function(a){if(0===arguments.length)return this._ignore;this._ignore=a;return this},route:function(a){if(0===arguments.length)return d.location.href;d.location=a},redirect:function(){var a=this.latest();a&&this.route(a);return this},back:function(){var a=this.history();1<a.length&&(a.pop(),this.history(a),this.redirect())},navigate:function(a){this.target(a);this.route(a)},latest:function(){var a=this.history();return a.length?a[a.length-1]:e},intercept:function(a){var b=
this;c(f).on("click",a,function(a){return b._onClick(a.target)});return this},_onClick:function(a){if(c(a).is(this._ignore))return!0;a=c(a).attr("href");var b=f.createElement("a");b.href=a;this.navigate(b.href);return!1}};d.Waypoint=new g})(window.jQuery||window.Zepto,window,document);
