(function(d,c,g,e){function f(){this._ignore=e}f.prototype={clear:function(){localStorage.removeItem("Waypoint.history");localStorage.removeItem("Waypoint.target");return this},resume:function(a){this.history();var b=this.target();if(b){this.target(e);if(b!==this.route())return this.redirect(),this;this.bookmark()}else if(this.route()!==this.latest())return this.redirect(),this;a&&a();return this},route:function(a){if(0===arguments.length){var b=c.location.pathname.split("/");return b[b.length-1]+
c.location.hash}c.location=a},bookmark:function(){this.push(this.route());return this},push:function(a){var b=this.history();b.push(a);5<b.length&&b.shift();this.history(b);return this},redirect:function(){var a=this.latest();a&&this.route(a);return this},back:function(){var a=this.history();1<a.length&&(a.pop(),this.history(a),this.redirect())},latest:function(){var a=this.history();return a.length?a[a.length-1]:e},history:function(a){if(0===arguments.length){var b=localStorage.getItem("Waypoint.history");
return JSON.parse(b)||[]}a?localStorage.setItem("Waypoint.history",JSON.stringify(a)):localStorage.removeItem("Waypoint.history")},target:function(a){if(0===arguments.length){var b=localStorage.getItem("Waypoint.target");return JSON.parse(b)}a?localStorage.setItem("Waypoint.target",JSON.stringify(a)):localStorage.removeItem("Waypoint.target")},intercept:function(a){var b=this;d(g).on("click",a,function(a){if(d(a.target).is(this._ignore))return!0;b.navigate(d(a.target).attr("href"));return!1});return this},
navigate:function(a){this.target(a);this.route(a)},ignore:function(a){if(0===arguments.length)return this._ignore;this._ignore=a;return this}};c.Waypoint=new f})(window.jQuery||window.Zepto,window,document);
