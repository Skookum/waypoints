(function(e,f,c,g){function h(){this._ignore=g;this._debug=!1}h.prototype={resume:function(a){this.history();var b=this.target(),c=this.latest(),d=this.route();if(b){this.target(g);if(b!==d)return this._debug&&console.log("Waypoints.resume(): bad link -- target ("+b+") does not match route ("+d+"), redirecting..."),this.redirect(),this;this._debug&&console.log("Waypoints.resume(): good link -- arrived at target("+b+"), bookmarking...");this.bookmark()}else if(c&&d!==c)return this._debug&&console.log("Waypoints.resume(): bad route -- route("+
d+") does not match latest ("+c+"), redirecting..."),this.redirect(),this;this._debug&&console.log("Waypoints.resume(): good route -- arrived at route("+d+"), triggering callback...");a&&a();return this},debug:function(a){if(0===arguments.length)return this._debug;this._debug=a;return this},clear:function(){localStorage.removeItem("Waypoints.history");localStorage.removeItem("Waypoints.target");return this},bookmark:function(){var a=this.route();this._debug&&console.log("Waypoints.bookmark(): bookmarking",
a);this.push(a);return this},push:function(a){var b=this.history();b.push(a);5<b.length&&b.shift();this.history(b);return this},history:function(a){if(0===arguments.length){var b=localStorage.getItem("Waypoints.history");return JSON.parse(b)||[]}if(a)return localStorage.setItem("Waypoints.history",JSON.stringify(a)),this;localStorage.removeItem("Waypoints.history");return this},target:function(a){if(0===arguments.length){var b=localStorage.getItem("Waypoints.target");return JSON.parse(b)}if(a)return localStorage.setItem("Waypoints.target",
JSON.stringify(a)),this;localStorage.removeItem("Waypoints.target");return this},ignore:function(a){if(0===arguments.length)return this._ignore;this._ignore=a;return this},route:function(a){if(0===arguments.length)return f.location.href;f.location=a;return this},redirect:function(){var a=this.latest();a&&this.route(a);return this},back:function(){var a=this.history();1<a.length&&(a.pop(),this.history(a),this.redirect());return this},navigate:function(a){var b=c.createElement("a");b.href=a;a=b.href;
this._debug&&console.log("Waypoints.navigate(): navigating to",a);this.target(a);this.route(a);return this},open:function(a){this._debug&&console.log("Waypoints.open(): opening safari for",a);var b=c.createElement("a");b.setAttribute("href",a);b.setAttribute("target","_blank");a=c.createEvent("HTMLEvents");a.initEvent("click",!0,!0);b.dispatchEvent(a)},latest:function(){var a=this.history();return a.length?a[a.length-1]:g},intercept:function(a){var b=this;e(c).on("click",a,function(){return b._onClick(this)});
return this},_onClick:function(a){if(e(a).is(this._ignore))return this._debug&&console.log("Waypoints.intercept(): ignoring click"),!0;a=e(a).attr("href");this._debug&&console.log("Waypoints.intercept(): intercepting click with href:",a);this.navigate(a);return!1}};f.Waypoints=new h})(window.jQuery||window.Zepto,window,document);
